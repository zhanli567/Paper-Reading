# CAN-LOC: Spoofing Detection and Physical Intrusion Localization on an In-Vehicle CAN Bus Based on Deep Features of Voltage Signals

    文章翻译为CAN-LOC：基于电压信号深度特征的车载 CAN 总线欺骗检测与物理入侵定位，2023年发表，文章链接：[CAN-LOC: Spoofing Detection and Physical Intrusion Localization on an In-Vehicle CAN Bus Based on Deep Features of Voltage Signals | IEEE Journals &amp; Magazine | IEEE Xplore](https://ieeexplore.ieee.org/abstract/document/10188890)。

    摘要部分：用于车载设备之间通信的控制器局域网（CAN）已被证明容易受到欺骗攻击。基于电压的欺骗检测（VBS-D）机制被认为是最先进的解决方案，补充了基于密码学的身份验证，由于 CAN 协议的消息大小有限，其安全性受到限制。不幸的是，VBS-D 机制容易受到连接到 CAN 总线的恶意设备的中毒，该设备专门设计用于在部署的 VBS-D 机制适应车辆移动时发生的环境变化时中毒。在本文中，我们使用基于深度学习的机制强化 VBS-D 机制，该机制在车辆启动时立即运行；该机制利用物理侧通道来检测和定位物理入侵，即使连接到 CAN 总线的恶意设备处于静默状态。我们在 CAN 总线原型上展示了该机制在各种物理入侵场景和不同温度下的有效性（100% 的入侵检测准确率和接近 0% 的错误率）。此外，我们提出了一种基于深度学习的 VBS-D 机制，该机制安全地适应环境变化。该机制的鲁棒性（99.8% 的设备识别准确率）在真实移动车辆上得到了证明。

    这篇文章实现了物理入侵的检测与定位，即便恶意设备处于静默状态也可以检测到；提出的连续ECU认证和识别机制可检测欺骗攻击；系统对多种物理入侵场景和温度变化具有高检测精度和鲁棒性。设计出的CAN-LOC系统包含物理入侵检测和定位机制以及连续ECU认证和识别机制，前者由物理入侵模块（使用具有特定结构的自动编码器）和入侵点定位模块（采用基于VGG16改进的一维CNN多分类器）组成，后者由ECU认证模块和ECU识别模块组成（基于CNN的二元分类器，网络结构不同）。运行流程是在车辆启动时，通过物理入侵检测和定位机制，依据合法ECU的电压信号判断CAN总线是否被入侵并定位入侵点，若未检测到入侵，车辆启动后，利用连续ECU认证和识别机制，基于CAN总线传输的电压信号检测欺骗攻击。但这篇文章可能无法应对极端噪声变化情况，未评估ECU进入特定模式或电压波动时的认证和识别机制性能。在创新方面，提出基于物理侧信道的检测定位机制，利用合法ECU电压信息进行检测，通过独特的指纹更新方法适应环境变化，训练过程无需ECU使用MAC通信，降低对加密的依赖。

![1740981292767](image/笔记/1740981292767.png)

    上图展示了CAN-LOC系统，由两部分组成，第一部分是物理入侵检测和定位机制，该部分使用深度自动编码器检测是否在CAN总线上引入了额外的ECU，以及CNN多类分类器报告ECU插入的确切位置；第二部分是连续ECU认证和识别机制，使用CNN二进制分类器，可以检测ECU欺骗攻击。

![1740981542138](image/笔记/1740981542138.png)

    上图为文章提供灵感，车辆中两个ECU的电压信号作为指纹识别非常有用，可以在CAN帧的上升沿和下降沿采样。

![1740981657455](image/笔记/1740981657455.png)

    上图展示了，在CAN网络中不同地方插入ECU，对于其他ECU的电压信号的影响。

![1740981771217](image/笔记/1740981771217.png)

    上图展示了CAN-LOC系统的运行流程，在车辆启动时，通过物理入侵检测和定位机制，依据合法ECU的电压信号判断CAN总线是否被入侵并定位入侵点，若未检测到入侵，车辆启动后，利用连续ECU认证和识别机制，基于CAN总线传输的电压信号检测欺骗攻击。

![1740981950997](image/笔记/1740981950997.png)

    上图展示从隐性1到显性0转换过程中返回的100个电压信号（由两个不同的ECU记录）。可以看出，数据显示出真实的噪声和电压波动，这在真实汽车中是预期的，但不会影响识别的准确性。

![1740982202167](image/笔记/1740982202167.png)

    上图呈现了干净和脏信号的平均 MAE 用于训练自动编码器的历元数的函数。可以看出，干净和脏信号的平均重建误差之间有很大的余量。（平均MAE是平均绝对误差，在本文物理入侵检测模块中，平均MAE用于评估自动编码器对电压信号的重建效果，自动编码器在训练阶段学习正常CAN总线拓扑下电压信号的模式，通过最小化重建误差优化模型，在训练过程中，使用两个仅包含良性数据的数据集，一个作为训练集，另一个作为验证集。训练自动编码器直至其在验证集上平均MAE达到最小，此时可认为自动编码器学习到了正常信号的特征模式）


# Intrusion Detection Using Transformer in Controller Area Network

    标题翻译为：在控制器局域网中使用 Transformer 进行入侵检测，2024年发表，文章链接：[在控制器局域网中使用 Transformer 进行入侵检测 |IEEE期刊和杂志 |IEEE Xplore](https://ieeexplore.ieee.org/document/10659904)。

    摘要部分：控制器局域网 （CAN） 协议的消息广播网络容易受到外部攻击。入侵检测系统 （IDS） 的持续开发旨在防止对车辆的恶意攻击。语言模型的时间序列分析已成为该领域的一种新方法，并为 IDS 性能的发展做出了重大贡献。然而，由于语言模型需要大量资源来处理，因此将其应用于实际车辆需要平衡模型性能与复杂性。在本文中，我们提出了一种高效的 IDS 模型，该模型使用基于 transformer 的技术，同时在有限的资源下进行作。所提出的 IDS 利用基于 transformer 的空间和时间数据分析机制，即使在数据有限的情况下也能快速响应攻击，并表现出出色的性能。由于 IDS 使用无监督学习，因此不需要在预处理期间标记输入序列。这种方法有助于保护车辆免受可预测和不可预测的攻击。此外，还可以扩展预测范围，使模型的性能在应对各种攻击场景时更加稳健。

    这篇文章提出了一个基于Transformer架构的IDS模型，通过无监督学习应对未知攻击，模型分别处理CAN ID序列和有效载荷序列，将二者输出向量相加，与实际CAN ID对比以判断是否存在攻击，训练时学习正常数据模式，评估时根据预测与实际CAN ID的匹配情况识别攻击，数据集使用的是韩国某实验室数据集，包含正常数据、洪水、模糊、故障攻击数据。数据处理的时候将十六进制的CAN ID和有效载荷转换为十进制，为避免二者取值范围重叠，给CAN ID加上256，并根据数据长度代码填充空位。神经网络方面采用Transformer网络，包含embeding层、positional层、多个transformer块以及线性层，transformer块由多头子注意力层、归一化层、前馈曾组成，与李沐所讲区别不大。在实验比较方面，与其他基于transformer的模型进行比较，在各种攻击检测中比较精度、召回率和F1值，同时在不同滑动窗口比较推理时间。

![1741065391093](image/笔记/1741065391093.png)

    上图为相关工作中提到的一些模型，作者对这些模型进行了总结归纳

![1741065449892](image/笔记/1741065449892.png)

    上图为本文模型的一个流程图，该模型分别使用两个序列：CAN ID 和有效负载序列。CAN ID 序列由一系列 CAN ID 组成，而有效载荷序列包括 8 字节的有效载荷以及 CAN ID。CAN ID 序列最后一个时隙中的 CAN ID 与有效载荷序列最后一个时隙中的 CAN ID 相同。因此，两个输入序列的最后一个插槽都使用相同的 CAN ID 填充。CAN ID 序列（最后一个令牌替换为掩码令牌）和有效负载序列（最后一个令牌被删除）分别通过模型。通过将 CAN ID 序列输出和有效载荷序列输出的最后一个槽中的两个 CAN ID 向量相加来计算最终向量。通过将真实 CAN ID 与最终向量中的前*n* 个分数进行比较来确定攻击。在训练期间，正常的 CAN 数据通过模型来学习正常数据中的模式。在评估过程中，正常和异常的 CAN 数据都会通过模型。当正常的 CAN 报文通过模型时，预测的 CAN ID 与实际 CAN ID 匹配，遵循学习的模式。但是，当异常（受攻击的）CAN 报文通过模型时，预测的 CAN ID 与真实 CAN ID 不匹配，因为它偏离了学习的模式。

![1741065560734](image/笔记/1741065560734.png)

    因CAN ID和DATA在0-255之间由重叠，故将CAN ID全部加256，数据字段中的空白用2304填充

![1741065656416](image/笔记/1741065656416.png)

    上图展示了transformer模型的结构，几乎没有什么改变。

![1741065708846](image/笔记/1741065708846.png)

    该图展示了神经网络中的超参数设置。

![1741065747977](image/笔记/1741065747977.png)

    该图展示了模型在不同攻击下不同滑动窗口的评估指标。文中之后篇幅均在和其他基于transformer的模型在不同攻击不同滑动窗口条件下比较精度、推理时间等等，故不作截图。

    没看出什么创新性，但可以从本文出发，阅读一些其他使用深度学习方法的文献。如下图所示。

![1741065985788](image/笔记/1741065985788.png)

![1741066023165](image/笔记/1741066023165.png)
