# CAN-LOC: Spoofing Detection and Physical Intrusion Localization on an In-Vehicle CAN Bus Based on Deep Features of Voltage Signals


    文章翻译为CAN-LOC：基于电压信号深度特征的车载 CAN 总线欺骗检测与物理入侵定位，2023年发表，文章链接：[CAN-LOC: Spoofing Detection and Physical Intrusion Localization on an In-Vehicle CAN Bus Based on Deep Features of Voltage Signals | IEEE Journals &amp; Magazine | IEEE Xplore](https://ieeexplore.ieee.org/abstract/document/10188890)。


    摘要部分：用于车载设备之间通信的控制器局域网（CAN）已被证明容易受到欺骗攻击。基于电压的欺骗检测（VBS-D）机制被认为是最先进的解决方案，补充了基于密码学的身份验证，由于 CAN 协议的消息大小有限，其安全性受到限制。不幸的是，VBS-D 机制容易受到连接到 CAN 总线的恶意设备的中毒，该设备专门设计用于在部署的 VBS-D 机制适应车辆移动时发生的环境变化时中毒。在本文中，我们使用基于深度学习的机制强化 VBS-D 机制，该机制在车辆启动时立即运行；该机制利用物理侧通道来检测和定位物理入侵，即使连接到 CAN 总线的恶意设备处于静默状态。我们在 CAN 总线原型上展示了该机制在各种物理入侵场景和不同温度下的有效性（100% 的入侵检测准确率和接近 0% 的错误率）。此外，我们提出了一种基于深度学习的 VBS-D 机制，该机制安全地适应环境变化。该机制的鲁棒性（99.8% 的设备识别准确率）在真实移动车辆上得到了证明。


    这篇文章实现了物理入侵的检测与定位，即便恶意设备处于静默状态也可以检测到；提出的连续ECU认证和识别机制可检测欺骗攻击；系统对多种物理入侵场景和温度变化具有高检测精度和鲁棒性。设计出的CAN-LOC系统包含物理入侵检测和定位机制以及连续ECU认证和识别机制，前者由物理入侵模块（使用具有特定结构的自动编码器）和入侵点定位模块（采用基于VGG16改进的一维CNN多分类器）组成，后者由ECU认证模块和ECU识别模块组成（基于CNN的二元分类器，网络结构不同）。运行流程是在车辆启动时，通过物理入侵检测和定位机制，依据合法ECU的电压信号判断CAN总线是否被入侵并定位入侵点，若未检测到入侵，车辆启动后，利用连续ECU认证和识别机制，基于CAN总线传输的电压信号检测欺骗攻击。但这篇文章可能无法应对极端噪声变化情况，未评估ECU进入特定模式或电压波动时的认证和识别机制性能。在创新方面，提出基于物理侧信道的检测定位机制，利用合法ECU电压信息进行检测，通过独特的指纹更新方法适应环境变化，训练过程无需ECU使用MAC通信，降低对加密的依赖。


![1740981292767](image/笔记/1740981292767.png)

    上图展示了CAN-LOC系统，由两部分组成，第一部分是物理入侵检测和定位机制，该部分使用深度自动编码器检测是否在CAN总线上引入了额外的ECU，以及CNN多类分类器报告ECU插入的确切位置；第二部分是连续ECU认证和识别机制，使用CNN二进制分类器，可以检测ECU欺骗攻击。

![1740981542138](image/笔记/1740981542138.png)

    上图为文章提供灵感，车辆中两个ECU的电压信号作为指纹识别非常有用，可以在CAN帧的上升沿和下降沿采样。

![1740981657455](image/笔记/1740981657455.png)

    上图展示了，在CAN网络中不同地方插入ECU，对于其他ECU的电压信号的影响。

![1740981771217](image/笔记/1740981771217.png)

    上图展示了CAN-LOC系统的运行流程，在车辆启动时，通过物理入侵检测和定位机制，依据合法ECU的电压信号判断CAN总线是否被入侵并定位入侵点，若未检测到入侵，车辆启动后，利用连续ECU认证和识别机制，基于CAN总线传输的电压信号检测欺骗攻击。

![1740981950997](image/笔记/1740981950997.png)

    上图展示从隐性1到显性0转换过程中返回的100个电压信号（由两个不同的ECU记录）。可以看出，数据显示出真实的噪声和电压波动，这在真实汽车中是预期的，但不会影响识别的准确性。

![1740982202167](image/笔记/1740982202167.png)

    上图呈现了干净和脏信号的平均 MAE 用于训练自动编码器的历元数的函数。可以看出，干净和脏信号的平均重建误差之间有很大的余量。（平均MAE是平均绝对误差，在本文物理入侵检测模块中，平均MAE用于评估自动编码器对电压信号的重建效果，自动编码器在训练阶段学习正常CAN总线拓扑下电压信号的模式，通过最小化重建误差优化模型，在训练过程中，使用两个仅包含良性数据的数据集，一个作为训练集，另一个作为验证集。训练自动编码器直至其在验证集上平均MAE达到最小，此时可认为自动编码器学习到了正常信号的特征模式）
